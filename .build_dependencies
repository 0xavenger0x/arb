#! /bin/sh
absolute_path(){
   dirlist="$1"
   retval=""
   for dir in $dirlist; do
      case $dir in
        /*) dir=$dir;;
        *) dir=$PWD/$dir;;
      esac
      retval=$retval" "$dir
   done
   echo $retval
}

set -e
if [ ! -d "mpir-2.7.0" ]; then
  wget http://mpir.org/mpir-2.7.0.tar.bz2
  tar -xvf mpir-2.7.0.tar.bz2
  cd mpir-2.7.0
  ./configure --enable-gmpcompat
  make
  cd ..
else
  echo "Using cached directory."
fi

if [ ! -d "mpfr-3.1.3" ]; then
  wget http://www.mpfr.org/mpfr-current/mpfr-3.1.3.tar.bz2
  tar -xvf mpfr-3.1.3.tar.bz2
  cd mpfr-3.1.3
  ./configure --with-gmp-build=$(absolute_path "../mpir-2.7.0")
  make
  cd ..
else
  echo "Using cached directory."
fi

if [ ! -d "flint-2.5.2" ]; then
  wget http://www.flintlib.org/flint-2.5.2.tar.gz
  tar -zxvf flint-2.5.2.tar.gz
  cd flint-2.5.2
  ./configure --disable-static --with-gmp=$(absolute_path "../mpir-2.7.0")  --with-mpfr=$(absolute_path "../mpfr-3.1.3")
  make
  cd ..
else
  echo "Using cached directory."
fi

